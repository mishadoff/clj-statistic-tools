#include<iostream>
#include<cstdio>
#include<cstring>
using namespace std;

char str[2000];

int main(){
   // freopen("in.txt","r",stdin);
   // freopen("out.txt","w",stdout);
    int t,cas=1;
    cin>>t;
    getchar();
    while(t--){
        gets(str);
        int i,len=strlen(str),mus=0,fre=0;
        bool key=0;
        for(i=0;i<len;i++){
            if(str[i]==':') key=1;
            else if(str[i]=='('){
                if(key) fre++;
                else mus++;
                key=0;
            }
            else if(str[i]==')'){
                if(key){
                    if(mus!=0){
                        mus--;
                        fre++;
                    }
                }
                else{
                    if(mus==0){
                        if(fre==0) break;
                        else fre--;
                    }
                    else mus--;
                }
                key=0;
            }
            else key=0;
        }
        printf("Case #%d: ",cas++);
        if(i==len && mus==0) puts("YES");
        else puts("NO");
    }
    return 0;
}
