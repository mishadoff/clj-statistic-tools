#include <algorithm>
#include <stdio.h>
#include <string.h>

using namespace std;
typedef long long ll;
int mark[100010];
ll rec[100010];
int ans[100010];
int main(){
	freopen("find_the_mintxt.txt", "r", stdin);
	freopen("out3.txt", "w", stdout);
	int T, cases = 0;
	int n, k;
    ll a, b, c, r;
	int i;
	scanf("%d", &T);
	while (T--) {
		scanf("%d%d", &n, &k);
		scanf("%lld%lld%lld%lld", &a, &b, &c, &r);
		memset(mark, 0, sizeof(mark));
		if (a <= (ll)k) {
			mark[a]++;
		}
		rec[0] = a;
		for (i = 1; i < k; i++) {
			a = (a * b + c) % r;
			rec[i] = a;
			if (a <= (ll)k)
				mark[a]++;	
		}
//		for (i = 0; i < k; i++)
//			printf("%d(%lld)\n", i, rec[i]);
		int start = 0;
		for (i = 0; i <= k; i++) {
			if (i) {
				if (rec[i - 1] < start) {
					if (mark[rec[i - 1]] == 1) {
						ans[i] = rec[i - 1];
						continue;
					} else {
						mark[rec[i - 1]]--;
					}
				} else if (rec[i - 1] <= k) {
					mark[rec[i - 1]]--;
				}	
			}
			while (mark[start]) {
				start++;
			}	
			ans[i] = start;
			start++;
		}
//		for (i = 0; i <= k; i++)
//			printf("%d--%d--\n", i, ans[i]);
		n -= k;
		n %= (k + 1);
		if (n == 0) 
			n = k + 1;
		n--;
//		printf("%d\n", n);
		printf("Case #%d: %d\n", ++cases, ans[n]);
	}
	return 0;
}
