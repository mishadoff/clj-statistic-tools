#include <cstdio>
#include <assert.h>
#include <cstdlib>
#include <iostream>
#include <algorithm>
#include <vector>
#include <cmath>
#include <set>
#include <cstring>
using namespace std;
typedef long long ll;
int i, j, k, m, n, ans;
int z[200002], last[200002];

int main()
{
    freopen("fb.in", "r", stdin);
    freopen("fb.txt", "w", stdout);

    int ti, tn;
    cin >> tn;
    for (ti = 1; ti <= tn; ti++)
    {
        ll a, b, c, r;
        cin >> n >> k >> a >> b >> c >> r;
        z[0] = a;
        for (i = 1; i < k; i++)
            z[i] = (b * z[i-1] + c) % r;

        set<int> S;
        for (i = 0; i <= k; i++)
        {
            S.insert(i);
            last[i] = -1;
        }
        for (i = 0; i < k; i++)
        {
            if (z[i] <= k)
            {
                last[z[i]] = i;
                S.erase(z[i]);
            }
        }
        for (i = k; i < 2*k+1; i++)
        {
            z[i] = *S.begin();
            S.erase(z[i]);
            if (z[i-k] <= k && last[z[i-k]] == i-k) {
                assert(!S.count(z[i-k]));
                S.insert(z[i-k]);
            }
        }

        cout << "Case #" << ti << ": " << z[k+(n-1-k)%(k+1)] << endl;
    }

    return 0;
}
