#include<stdio.h>
#define SIZE 1000010
int m[SIZE],d[SIZE],k,cnt[SIZE];
void insert(int x,int v){
    while(x<=k+1){
        d[x]+=v;
        x+=x&-x;
    }
}
int qq(int x){
    int res=0;
    while(x){
        res+=d[x];
        x-=x&-x;
    }
    return res;
}
int main(){
    int T,cs=0,i,a,b,c,r,n;
    scanf("%d",&T);
    while(T--){
        scanf("%d%d",&n,&k);
        for(i=1;i<=k+1;i++)cnt[i]=d[i]=0;
        scanf("%d%d%d%d",&a,&b,&c,&r);
        m[0]=a;
        for(i=1;i<k;i++)
            m[i]=((long long)b*m[i-1]+c)%r;
        for(i=0;i<k;i++){
            m[i]++;
            if(m[i]<=k+1){
                cnt[m[i]]++;
                if(cnt[m[i]]==1)insert(m[i],1);
            }
        }
        for(i=0;i<=k;i++){
            int ll=1,rr=k+1;
            while(ll<rr){
                int mm=(ll+rr)>>1;
                if(qq(mm)==mm)ll=mm+1;
                else rr=mm;
            }
            m[k+i]=ll;
            cnt[m[k+i]]++;
            if(cnt[m[k+i]]==1)insert(ll,1);
            if(m[i]<=k+1){
                cnt[m[i]]--;
                if(!cnt[m[i]])insert(m[i],-1);
            }
        }
        printf("Case #%d: %d\n",++cs,m[(n-1-k)%(k+1)+k]-1);
    }
    return 0;
}
