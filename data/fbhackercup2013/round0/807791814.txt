#include<iostream>
#include<set>
#include<map>
#include<vector>
using namespace std;

int main() {
	int t;
	cin>>t;
	for(int tn=0;tn<t;tn++) {
		int n,k;
		cin>>n>>k;
		long long a,b,c,r;
		cin>>a>>b>>c>>r;
		vector<int> arr(k+1,0);
		arr[0] = a;
		set<int> valid;
		map<int,int> cnt;
		for(int i=0;i<=k;i++)
			valid.insert(i);
		valid.erase(a);
		cnt[a]=1;
		for(int i=1;i<k;i++) {
			arr[i] = ( b * arr[i-1] + c ) % r;
			if(cnt.find(arr[i])==cnt.end())
				cnt[arr[i]]=0;
			cnt[arr[i]]++;
			valid.erase(arr[i]);
		}
		vector<int> ans(k+1,0);
		for(int i=0;i<=k;i++) {
			ans[i] = *valid.begin();
			valid.erase(valid.begin());
			if(--cnt[arr[i]]==0)
				valid.insert(arr[i]);
		}
		n-=k;
		n--;
		cout<<"Case #"<<tn+1<<": "<<ans[n%(k+1)]<<endl;
	}
}

