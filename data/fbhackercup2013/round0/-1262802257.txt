#include <cstdio>
#include <iostream>
#include <string>
#include <algorithm>
#include <vector>
#include <cmath>
#include <queue>
#include <set>
#include <map>
#include <stack>
using namespace std;

#define For(i,n) for(int i=0; i<(n); i++)
typedef long long ll;

ll n,k,a,b,c,r;
ll seed;
set<ll> S;

ll gen()
{
    ll vys=seed;
    seed=b*seed+c;
    seed%=r;
    return vys;
}

int main()
{
    int t;
    scanf("%d ",&t);
    For(i1,t) {
        scanf("%lld %lld %lld %lld %lld %lld ",&n,&k,&a,&b,&c,&r);
        seed=a;
        S.clear();
        For(i,k+1) S.insert(i);
        vector<ll> M;
        vector<int> P; P.resize(k+1,0);
        For(i,k) {
            ll x=gen();
            S.erase(x);
            if(x<=k) P[x]++;
            M.push_back(x);
        }
        vector<ll> A; A.resize(k+1);
        For(i,k+1) {
            ll x=*(S.begin());
            A[i]=x;
            P[x]++;
            S.erase(S.begin());
            if(i!=k && M[i]<=k) {P[M[i]]--; if(P[M[i]]==0) S.insert(M[i]);}
        }
        //For(i,k) printf("%lld ",M[i]); printf("\n");
        //For(i,k+1) printf("%lld ",A[i]); printf("\n");
        ll p=n-k-1;
        ll vys=A[p%(k+1)];
        printf("Case #%d: %lld\n",i1+1,vys);
    }
return 0;
}
