#include<cstdio>
#include<cctype>
#include<iostream>
#include<cstring>
#include<string>
#include<map>
#include<algorithm>

#define N 100009

using namespace std;

int n,m,a,b,c,r,f[10*N],T;
int C[N];
map<int,int> h;

void add(int x,int y)
{
    for(;x<N;x+=x&-x) C[x]+=y;
}
int sum(int x)
{
    int ret=0;
    for(;x;x-=x&-x) ret+=C[x];
    return ret;
}
int find()
{
    int i,cnt=0,ret=0;
    for(i=20;i>=0;i--)
    {
        ret+=(1<<i);
        if(ret>=N||cnt+C[ret]>=1) ret-=(1<<i);
        else cnt+=C[ret];
    }
    return ret+1;
}
int main()
{
    freopen("find_the_mintxt.txt","r",stdin);
    freopen("out.txt","w",stdout);
    cin>>T;
    for(int cas=1;cas<=T;cas++)
    {
        h.clear();
        cin>>n>>m>>a>>b>>c>>r;
        f[0]=a;
        for(int i=1;i<m;i++) f[i]=(1ll*b*f[i-1]+c)%r;
        for(int i=1;i<N;i++) C[i]=i&-i;
        int tot=0;
        for(int i=0;i<m;i++)
        {
            f[i]++,h[f[i]]++;
            if(f[i]<N&&h[f[i]]==1) add(f[i],-1);
            if(f[i]<=m) tot++;
        }
        int i=m;
        while(1)
        {
            f[i]=find();
            h[f[i]]++,h[f[i-m]]--;
            if(h[f[i]]==1) add(f[i],-1);
            if(f[i]<=m) tot++;
            if(f[i-m]<N&&h[f[i-m]]==0) add(f[i-m],1);
            if(f[i-m]<=m) tot--;
            //if(i>=n-1) break;
            if(i>=2*m&&tot==m) break;
            i++;
        }
        int res;
        if(i>=n-1) res=f[n-1]-1;
        else
        {
            int p=(n-i-2)%(m+1);
            if(!p) res=m;
            else res=f[i-m+p]-1;
        }
        printf("Case #%d: %d\n",cas,res);
    }
    fclose(stdout);
    return 0;
}
