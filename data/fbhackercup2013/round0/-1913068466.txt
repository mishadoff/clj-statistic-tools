#include <cstdio>
#include <cstdlib>
#include <cstring>

int t,id;
int i,j,len,flag,p,q;
char st[200];

int main()
{
	freopen("balanced_smileystxt.txt","r",stdin);freopen("b.out","w",stdout);
	scanf("%d",&t);getchar();
	for (id=1;id<=t;id++)
	{
		gets(st);
		len=strlen(st);
		flag=0;p=0;q=0;
		for (i=0;i<len;i++)
		if ((st[i]>='a' && st[i]<='z') || ' ' || st[i]==':' || st[i]=='(' || st[i]==')')
		{
			if (st[i]=='(')
			{
				flag++;
				if (i>0 && st[i-1]==':')p++;
			}
			if (st[i]==')')
			{
				flag--;
				if (i>0 && st[i-1]==':')q++;
			}
			if (flag<0)
			{
				if (q+flag>=0)
				{
					q+=flag;
					flag=0;
				}
			}
			if (flag<0) break;
		}
		else break;
		if (i<len) printf("Case #%d: NO\n",id);
		else 
		{
			if (flag>0)
				if (p>=flag)
				{
					p-=flag;
					flag=0;
				}
			if (flag==0) 
			{
				flag=0;p=0;q=0;
				for (i=len-1;i>=0;i--)
				if ((st[i]>='a' && st[i]<='z') || ' ' || st[i]==':' || st[i]=='(' || st[i]==')')
				{
					if (st[i]=='(')
					{
						flag--;
						if (i>0 && st[i-1]==':')p++;
					}
					if (st[i]==')')
					{
						flag++;
						if (i>0 && st[i-1]==':')q++;
					}
					if (flag<0)
					{
						if (p+flag>=0)
						{
							p+=flag;
							flag=0;
						}
					}
					if (flag<0) break;
				}
				else break;
				if (i>=0) printf("Case #%d: NO\n",id);
				else 
				{
					if (flag>0)
						if (q>=flag)
						{
							q-=flag;
							flag=0;
						}
					if (flag==0) 
					{
						printf("Case #%d: YES\n",id);
					}
					else printf("Case #%d: NO\n",id);
				}
			}
			else printf("Case #%d: NO\n",id);
		}
	}
	return 0;
}
/*
6
:((
i am sick today (:()
(:)
hacker cup: started :):)
)(
:(:(:(:(:)))(()
*/