#include <cstdio>
#include <cstring>
#include <algorithm>

using namespace std;

char s[128];
int T;
int TS = 0;
int foi[128][128];
int PD[128][128];

int calc(int p, int saldo){
    if(saldo < 0)
        return 0;
    if(!s[p])
        return (saldo? 0 : 1);
    if(foi[p][saldo] == TS)
        return PD[p][saldo];

    int a, r = 0;

    if(s[p] == '('){
        if(p && s[p - 1] == ':')
            r = calc(p + 1, saldo);
        a = calc(p + 1, saldo + 1);
        r = max(a, r);
    }
    else if(s[p] == ')'){
        if(p && s[p - 1] == ':')
            r = calc(p + 1, saldo);
        a = calc(p + 1, saldo - 1);
        r = max(a, r);
    }
    else
        r = calc(p + 1, saldo);

    foi[p][saldo] = TS;
    PD[p][saldo] = r;
    return r;
}

int main(){
    memset(foi, 0, sizeof(foi));
    for(scanf("%d\n", &T); T--;){
        TS++;
        fgets(s, 128, stdin);
        printf("Case #%d: ", TS);
        printf(calc(0, 0)? "YES\n" : "NO\n");
    }

    return 0;
}
