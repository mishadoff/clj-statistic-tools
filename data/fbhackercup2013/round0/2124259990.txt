#include <cstdlib>
#include <cstring>
#include <cstdio>

int t;
int n,k;
int a,b,c,r;
__int64 m[200010],flag[100010];
int i,j,id;

int cmp(const void *a,const void *b)
{return *(int *)a- *(int *)b;}

int main()
{
	freopen("find_the_mintxt.txt","r",stdin);freopen("c.out","w",stdout);
	scanf("%d",&t);
	for (id=1;id<=t;id++)
	{
		scanf("%d%d",&n,&k);
		scanf("%d%d%d%d",&a,&b,&c,&r);
		memset(flag,0,sizeof(flag));
		m[0]=a;n--;
		for (i=1;i<k;i++)m[i]= (b * m[i - 1] + c) % r;
		n=(n-k)%(k+1)+k;

		for (i=0;i<k;i++)
			if (m[i]<=k)flag[m[i]]++;
		j=0;
		for (;i<=n;i++)
		{
//			j=1;	
			while(flag[j]>=1)
			{
				j++;
				//if (j>k+1)j=1;
			}
			flag[j]=1;
			m[i]=j;
			j++;
			if (m[i-k]<=k)
			{
				flag[m[i-k]]--;
				if (m[i-k]<j && flag[m[i-k]]==0)j=m[i-k];
			}
		}
//		for (i=0;i<=n;i++)printf("m[%d]=%d\n",i,m[i]);
		printf("Case #%d: %I64d\n",id,m[n]);
	}
	return 0;
}