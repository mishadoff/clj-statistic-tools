#include <iostream>
#include <vector>
using namespace std;
int main(){
	freopen("input.txt","r",stdin);
	freopen("output.txt","w", stdout);
	
	__int64 t;
	
	cin >> t;
	vector<__int64> a(1000000);
	vector<__int64> val;
	__int64 l;
	for(int tt = 0; tt < t; tt++) {
		val.resize(0);
		for(int i = 0; i < 1000000; i++)
			a[i] = 0;
		__int64 n,k,aa,bb,cc,rr;
		cin>>n>>k;
		cin>>aa>>bb>>cc>>rr;
		l = aa;
		if (l < 1000000)
		a[l]++;
		val.push_back(l);
		for(int i = 1; i < k; i++) {
			l = (bb * l + cc) % rr;
			if (l < 1000000)
				a[l]++;
			val.push_back(l);
		}
		vector<__int64> next;
		__int64 j = 0;
		__int64 ii = 0;
		bool ok = false;
		while (!ok) {
			__int64 i = 0;
			for(; i < 1000000; i++)
				if (a[i] == 0) {
					ii = i;
					do{
						next.push_back(ii);
						if (ii < 1000000)
							a[ii]++;
						val.push_back(ii);
						if (next.size() != 1 && next[0] == next[next.size() - 1]) {
							ok = true;
							break;
						}
						if (val[j] < 1000000)
							a[val[j]]--;
						ii = val[j];
						j++;
					} while (val[j-1] < 1000000 && a[val[j-1]] == 0 && val[j-1] <= i);
					if (ok) 
						break;
				}
		}
		cout<<"Case #"<<tt + 1<<": "<< next[(n-k - 1) % (k + 1)] <<endl;
	}
}