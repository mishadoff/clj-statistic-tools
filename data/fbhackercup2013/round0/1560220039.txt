#include <cstdio>
#include <map>

using namespace std;

int m[1000005];

int main(void) {
  int nt;
  scanf ("%d\n", &nt);
  for (int tn=1; tn <= nt; tn++) {
    printf ("Case #%d: ", tn);

    int n, k;
    int a, b, c, r;
    scanf ("%d %d", &n, &k);
    scanf ("%d %d %d %d", &a, &b, &c, &r);

    map <int, int> cnt;
    m[0] = a;
    cnt[a] = 1;
    for (int i = 1; i < k; i++) {
      m[i] = ((long long)b * m[i - 1] + c) % r;
      cnt[m[i]]++;
//      printf ("%d %d\n", i, m[i]);
    }
    int cur = 0;
    int next = -1;
    for (int i = k; i <= k + k + k + 3; i++) {
      while (cnt[cur] > 0) {
        cur++;
      }
      if (next != -1) {
        m[i] = next;
        next = -1;
      } else {
        m[i] = cur++;
      }

      cnt[m[i - k]]--;
      cnt[m[i]]++;

//      printf ("%d %d\n", i, m[i]);

      if (cnt[m[i - k]] == 0 && m[i - k] < cur) {
        next = m[i - k];
      }
    }

    printf ("%d\n", m[(n - k - 1) % (k + 1) + k]);
  }

  return 0;
}
